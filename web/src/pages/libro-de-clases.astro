---
/**
 * Generador de Portada de Libro de Clases (SENCE)
 * Permite configurar y previsualizar la portada oficial para impresi√≥n.
 */
import DashboardLayout from "../layouts/DashboardLayout.astro";
import { ESCUELA_ACTUAL } from "../lib/mockData";
---

<DashboardLayout title="Libro de Clases Digital" escuela={ESCUELA_ACTUAL}>
  
  <div 
    x-data="{ 
      schoolName: 'CONDUCTORES CHILL√ÅN', 
      courseName: 'CURSO PROFESIONAL CLASE A-2', 
      courseId: '156.2', 
      senceCode: '1237920905', 
      startDate: '2026-01-17', 
      endDate: '2026-02-26', 
      address: 'CALLE CARRERA 74 - CHILL√ÅN', 
      schedule: 'LUNES A VIERNES 17:30 A 22:30',
      instructors: {
          teoria: 'Juan P√©rez',
          practica: 'Mar√≠a Gonz√°lez',
          psicologia: 'Ana Silva'
      }
    }"
    class="flex flex-col lg:flex-row gap-8 h-full"
  >

    <!-- Panel Izquierdo: Configuraci√≥n (No se imprime) -->
    <div class="w-full lg:w-1/3 bg-white p-6 rounded-lg shadow-sm border border-gray-200 overflow-y-auto no-print">
      <h2 class="text-xl font-bold text-gray-800 mb-6 border-b pb-2">Configuraci√≥n del Libro</h2>
      
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700">Nombre Autoescuela</label>
          <input type="text" x-model="schoolName" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2">
        </div>

        <div>
          <label class="block text-sm font-medium text-gray-700">Nombre del Curso</label>
          <input type="text" x-model="courseName" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2">
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700">ID Curso</label>
            <input type="text" x-model="courseId" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">C√≥digo SENCE</label>
            <input type="text" x-model="senceCode" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2">
          </div>
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-gray-700">Fecha Inicio</label>
            <input type="date" x-model="startDate" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2">
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700">Fecha T√©rmino</label>
            <input type="date" x-model="endDate" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2">
          </div>
        </div>

        <div>
           <label class="block text-sm font-medium text-gray-700">Direcci√≥n de Ejecuci√≥n</label>
           <input type="text" x-model="address" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2">
        </div>

        <div>
           <label class="block text-sm font-medium text-gray-700">Horario</label>
           <textarea x-model="schedule" rows="2" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-2"></textarea>
        </div>

        <!-- Cuerpo Docente -->
        <div>
            <h3 class="text-sm font-bold text-gray-800 mt-4 mb-2">Cuerpo Docente</h3>
            <div class="space-y-2">
                <div>
                    <label class="block text-xs text-gray-500">Teor√≠a / Legislaci√≥n</label>
                    <select x-model="instructors.teoria" class="block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-1">
                        <option>Juan P√©rez</option>
                        <option>Pedro Soto</option>
                    </select>
                </div>
                 <div>
                    <label class="block text-xs text-gray-500">Pr√°ctica</label>
                    <select x-model="instructors.practica" class="block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-1">
                        <option>Mar√≠a Gonz√°lez</option>
                        <option>Carlos Ruiz</option>
                    </select>
                </div>
                 <div>
                    <label class="block text-xs text-gray-500">Psicolog√≠a</label>
                    <select x-model="instructors.psicologia" class="block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm border p-1">
                        <option>Ana Silva</option>
                        <option>Roberto D√≠az</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="pt-4">
             <button 
                onclick="window.print()" 
                class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"
            >
                üñ®Ô∏è Imprimir Libro Oficial
            </button>
        </div>
      </div>
    </div>

    <!-- Panel Derecho: Vista Previa A4 -->
    <div class="flex-1 bg-gray-100 p-8 overflow-y-auto no-print-bg flex justify-center">
        
        <!-- Hoja A4 -->
        <div class="aspect-[210/297] w-full max-w-[210mm] min-h-[297mm] bg-white shadow-2xl relative p-10 border-2 border-black print-sheet">
            
            <!-- Contenido del Libro -->
            <div class="h-full flex flex-col justify-between">
                
                <!-- Encabezado -->
                <div class="flex justify-between items-start border-b-2 border-black pb-4 mb-8">
                     <div class="text-xl font-bold italic">
                        Conductores <span class="text-blue-600 text-black-print">Chill√°n</span>
                    </div>
                    <div class="text-right">
                         <h1 class="text-2xl font-bold uppercase underline">LIBRO DE CONTROL DE CLASES</h1>
                         <p class="text-sm font-bold mt-1">ORGANISMO T√âCNICO DE CAPACITACI√ìN</p>
                    </div>
                </div>

                <!-- Tabla de Datos Principal -->
                <div class="flex-1">
                    <div class="space-y-6 text-sm font-serif">
                        
                        <div class="flex border-b border-black pb-1 items-end">
                            <span class="font-bold w-64">NOMBRE DE LA AUTOESCUELA :</span>
                            <span class="flex-1 pl-2 uppercase" x-text="schoolName"></span>
                        </div>

                         <div class="flex border-b border-black pb-1 items-end">
                            <span class="font-bold w-64">NOMBRE DEL CURSO :</span>
                            <span class="flex-1 pl-2 uppercase" x-text="courseName"></span>
                        </div>

                         <div class="flex border-b border-black pb-1 items-end">
                            <span class="font-bold w-64">C√ìDIGO SENCE :</span>
                            <span class="flex-1 pl-2" x-text="senceCode"></span>
                        </div>

                         <div class="flex border-b border-black pb-1 items-end">
                            <span class="font-bold w-64">ID CURSO :</span>
                            <span class="flex-1 pl-2" x-text="courseId"></span>
                        </div>

                        <div class="grid grid-cols-2 gap-8">
                             <div class="flex border-b border-black pb-1 items-end">
                                <span class="font-bold w-32">FECHA INICIO :</span>
                                <span class="flex-1 pl-2" x-text="startDate"></span>
                            </div>
                             <div class="flex border-b border-black pb-1 items-end">
                                <span class="font-bold w-32">FECHA T√âRMINO :</span>
                                <span class="flex-1 pl-2" x-text="endDate"></span>
                            </div>
                        </div>

                         <div class="flex border-b border-black pb-1 items-end">
                            <span class="font-bold w-64">DIRECCI√ìN DE EJECUCI√ìN :</span>
                            <span class="flex-1 pl-2 uppercase" x-text="address"></span>
                        </div>

                         <div class="flex border-b border-black pb-1 items-end">
                            <span class="font-bold w-64">HORARIO :</span>
                            <span class="flex-1 pl-2 uppercase" x-text="schedule"></span>
                        </div>

                    </div>

                    <!-- Tabla Cuerpo Docente en el Documento -->
                    <div class="mt-16">
                        <h3 class="text-center font-bold uppercase underline mb-4">N√ìMINA DE FACILITADORES</h3>
                        <table class="w-full border-collapse border border-black text-sm">
                            <thead>
                                <tr class="bg-gray-100 print-bg-gray">
                                    <th class="border border-black p-2 text-left w-1/3">M√ìDULO / √ÅREA</th>
                                    <th class="border border-black p-2 text-left">NOMBRE INSTRUCTOR</th>
                                    <th class="border border-black p-2 text-center w-32">FIRMA</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td class="border border-black p-2 font-bold">TEOR√çA / LEGISLACI√ìN</td>
                                    <td class="border border-black p-2 uppercase" x-text="instructors.teoria"></td>
                                    <td class="border border-black p-2"></td>
                                </tr>
                                <tr>
                                    <td class="border border-black p-2 font-bold">PR√ÅCTICA DE CONDUCCI√ìN</td>
                                    <td class="border border-black p-2 uppercase" x-text="instructors.practica"></td>
                                    <td class="border border-black p-2"></td>
                                </tr>
                                <tr>
                                    <td class="border border-black p-2 font-bold">PSICOLOG√çA</td>
                                    <td class="border border-black p-2 uppercase" x-text="instructors.psicologia"></td>
                                    <td class="border border-black p-2"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                </div>

                <!-- Footer -->
                <div class="text-center text-xs border-t-2 border-black pt-4 mt-8">
                     <p>USO EXCLUSIVO PARA CONTROL DE ASISTENCIA Y CONTENIDOS SENCE</p>
                </div>
            </div>

        </div>

    </div>

  </div>
</DashboardLayout>

<style>
    @media print {
        @page { margin: 0; size: A4; }
        body { -webkit-print-color-adjust: exact; print-color-adjust: exact; background: white; }
        .no-print { display: none !important; }
        .no-print-bg { background: white !important; padding: 0 !important; }
        
        /* Dashboard layout hiding hack if necessary, ideally DashboardLayout handles print hidden */
        nav, aside, header { display: none !important; }

        .print-sheet {
            width: 100% !important;
            height: 100vh !important;
            border: none !important;
            shadow: none !important;
            margin: 0 !important;
            padding: 2cm !important; /* Margen oficial de impresi√≥n */
            position: absolute;
            top: 0;
            left: 0;
            max-width: none !important;
        }

        .text-black-print { color: black !important; }
        .print-bg-gray { background-color: #f3f4f6 !important; }
    }
</style>
