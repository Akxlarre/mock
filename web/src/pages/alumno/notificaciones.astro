---
/**
 * Centro de Notificaciones - Alumno
 * Notificaciones relevantes para alumnos
 */
import DashboardLayout from "../../layouts/DashboardLayout.astro";
import Card from "../../components/ui/Card.astro";
import Button from "../../components/ui/Button.astro";

// Notificaciones para ALUMNO
const notifications = [
    // CLASES PR√ìXIMAS
    {
        id: 1,
        priority: "urgent",
        title: "‚è∞ Clase ma√±ana a las 09:00",
        message:
            "Clase pr√°ctica con instructor Carlos Rojas - Veh√≠culo ABCD-12 - Plaza Central",
        time: "Hace 2 horas",
        unread: true,
        icon: "üöó",
        action: { label: "Ver detalles", href: "/alumno/clases" },
    },
    {
        id: 2,
        priority: "high",
        title: "Recordatorio: Clase en 2 d√≠as",
        message: "Clase te√≥rica - 06/02 a las 15:00 - Sala 2",
        time: "Hace 5 horas",
        unread: true,
        icon: "üìö",
        action: { label: "Confirmar asistencia", href: "/alumno/clases" },
    },

    // PAGOS
    {
        id: 3,
        priority: "urgent",
        title: "üö® Cuota vencida",
        message: "Cuota #2 vencida el 01/02/2026 - Total pendiente: $150.000",
        time: "Hace 1 d√≠a",
        unread: true,
        icon: "üí∞",
        action: { label: "Pagar ahora", href: "/alumno/pagos" },
    },
    {
        id: 4,
        priority: "medium",
        title: "Recordatorio de pago",
        message: "√öltima cuota vence en 7 d√≠as (11/02/2026)",
        time: "Hace 2 d√≠as",
        unread: false,
        icon: "üìÖ",
        action: { label: "Ver estado cuenta", href: "/alumno/pagos" },
    },

    // PROGRESO
    {
        id: 5,
        priority: "low",
        title: "‚úÖ Clase completada",
        message:
            "Clase pr√°ctica #8 de 12 - Excelente progreso en estacionamiento",
        time: "Hace 2 d√≠as",
        unread: false,
        icon: "üéØ",
        action: { label: "Ver progreso", href: "/alumno/dashboard" },
    },
    {
        id: 6,
        priority: "low",
        title: "¬°50% completado!",
        message: "Has completado 6 de 12 clases - Vas muy bien, sigue as√≠",
        time: "Hace 3 d√≠as",
        unread: false,
        icon: "üéâ",
    },

    // CERTIFICADOS
    {
        id: 7,
        priority: "high",
        title: "üèÜ ¬°Certificado disponible!",
        message:
            "Completaste todas las clases - Tu certificado est√° listo para descargar",
        time: "Hace 4 d√≠as",
        unread: true,
        icon: "üéì",
        action: { label: "Descargar", href: "/alumno/certificado" },
    },

    // DOCUMENTOS
    {
        id: 8,
        priority: "medium",
        title: "Certificado psicot√©cnico por vencer",
        message: "Tu certificado vence en 15 d√≠as - Recuerda renovarlo",
        time: "Hace 5 d√≠as",
        unread: false,
        icon: "üß†",
        action: { label: "Agendar evaluaci√≥n", href: "/alumno/ayuda" },
    },
    {
        id: 9,
        priority: "low",
        title: "Documento aprobado",
        message: "Tu certificado de salud fue aprobado por secretar√≠a",
        time: "Hace 1 semana",
        unread: false,
        icon: "‚úÖ",
    },

    // CANCELACIONES
    {
        id: 10,
        priority: "medium",
        title: "Clase cancelada por instructor",
        message: "Tu clase del 03/02 fue cancelada - No cuenta como tomada",
        time: "Hace 1 semana",
        unread: false,
        icon: "‚ùå",
        action: { label: "Ver Horario", href: "/alumno/horario" },
    },

    // ENCUESTAS
    {
        id: 11,
        priority: "low",
        title: "Cu√©ntanos tu experiencia",
        message: "¬øC√≥mo fue tu clase con el instructor Carlos Rojas?",
        time: "Hace 1 semana",
        unread: false,
        icon: "‚≠ê",
        action: { label: "Evaluar", href: "/alumno/encuesta" },
    },

    // PROMOCIONES
    {
        id: 12,
        priority: "low",
        title: "¬°Recomienda y gana!",
        message:
            "Por cada amigo que se matricule, obt√©n 10% descuento en tu pr√≥ximo curso",
        time: "Hace 2 semanas",
        unread: false,
        icon: "üéÅ",
    },

    // CONSEJOS
    {
        id: 13,
        priority: "low",
        title: "Consejo de conducci√≥n",
        message:
            "Recuerda siempre revisar los espejos antes de cambiar de pista",
        time: "Hace 2 semanas",
        unread: false,
        icon: "üí°",
    },
];

const urgent = notifications.filter((n) => n.priority === "urgent");
const unreadCount = notifications.filter((n) => n.unread).length;
---

<DashboardLayout
    title="Notificaciones"
    userRole="alumno"
    userName="Mar√≠a Gonz√°lez"
>
    <div class="max-w-4xl mx-auto">
        <!-- Header -->
        <div class="mb-6">
            <h1 class="text-3xl font-bold text-gray-900 mb-2">
                üîî Mis Notificaciones
            </h1>
            <p class="text-secondary">
                {unreadCount} sin leer ‚Ä¢ {notifications.length} totales
            </p>
        </div>

        <!-- Urgente -->
        {
            urgent.length > 0 && (
                <Card class="mb-6 p-4 bg-yellow-50 border-l-4 border-yellow-500">
                    <div class="flex items-center gap-3">
                        <span class="text-3xl">‚ö†Ô∏è</span>
                        <div class="flex-1">
                            <p class="font-semibold text-yellow-900">
                                Atenci√≥n requerida
                            </p>
                            <p class="text-sm text-yellow-700">
                                Tienes {urgent.length} notificaci√≥n(es)
                                importante(s)
                            </p>
                        </div>
                    </div>
                </Card>
            )
        }

        <!-- Lista de notificaciones -->
        <div class="space-y-3">
            {
                notifications.map((notif) => (
                    <Card
                        class={`p-4 ${notif.unread ? "bg-blue-50 border-l-4 border-blue-500" : ""} ${notif.priority === "urgent" ? "border-l-4 border-red-500 bg-red-50" : ""} ${notif.priority === "high" && notif.unread ? "border-l-4 border-orange-500 bg-orange-50" : ""}`}
                    >
                        <div class="flex items-start justify-between gap-4">
                            <div class="flex items-start gap-3 flex-1">
                                <span class="text-2xl flex-shrink-0">
                                    {notif.icon}
                                </span>
                                <div class="flex-1 min-w-0">
                                    <div class="flex items-center gap-2 mb-1">
                                        {notif.unread && (
                                            <span class="w-2 h-2 bg-blue-600 rounded-full" />
                                        )}
                                        <h3 class="font-semibold text-gray-900">
                                            {notif.title}
                                        </h3>
                                    </div>
                                    <p class="text-sm text-gray-700 mb-2">
                                        {notif.message}
                                    </p>
                                    <p class="text-xs text-gray-500">
                                        {notif.time}
                                    </p>
                                </div>
                            </div>
                            {notif.action && (
                                <Button
                                    href={notif.action.href}
                                    variant={
                                        notif.priority === "urgent" ||
                                        notif.priority === "high"
                                            ? "primary"
                                            : "secondary"
                                    }
                                    class="flex-shrink-0"
                                >
                                    {notif.action.label}
                                </Button>
                            )}
                        </div>
                    </Card>
                ))
            }
        </div>

        <!-- Tip -->
        <Card class="mt-6 p-4 bg-gradient-to-r from-blue-50 to-purple-50">
            <div class="flex items-start gap-3">
                <span class="text-2xl">üí°</span>
                <div>
                    <p class="font-semibold text-gray-900 mb-1">
                        ¬øSab√≠as que...?
                    </p>
                    <p class="text-sm text-gray-700">
                        Puedes activar notificaciones push en tu navegador para
                        recibir recordatorios de tus clases en tiempo real
                    </p>
                </div>
            </div>
        </Card>
    </div>
</DashboardLayout>
