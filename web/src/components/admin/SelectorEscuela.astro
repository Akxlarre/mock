---
/**
 * Selector de Escuela
 * RF-012: Multi-Escuela (Autoescuela Chillán y Conductores Chillán)
 */

interface Props {
    class?: string;
}

const { class: className = "" } = Astro.props;
---

<div class={`flex items-center gap-2 ${className}`}>
    <label for="school-selector" class="text-sm text-secondary font-medium"
        >Escuela:</label
    >
    <select
        id="school-selector"
        class="h-10 px-3 text-sm bg-white border border-gray-300 rounded-md focus:ring-2 focus:ring-gray-900 focus:border-gray-900 transition-colors"
    >
        <option value="autoescuela-chillan">Autoescuela Chillán</option>
        <option value="conductores-chillan">Conductores Chillán</option>
        <option value="all">Todas las Sedes</option>
    </select>
</div>

<script>
    const selector = document.getElementById(
        "school-selector",
    ) as HTMLSelectElement;

    if (selector) {
        // Cargar selección guardada
        const savedSchool =
            localStorage.getItem("selected_school") || "chillan";
        selector.value = savedSchool;

        // Listener cambio
        selector.addEventListener("change", (e) => {
            const target = e.target as HTMLSelectElement;
            const newSchool = target.value;
            const schoolName = target.options[target.selectedIndex].text;

            // Guardar en localStorage
            localStorage.setItem("selected_school", newSchool);

            // Notificar cambio
            alert(
                `✓ Escuela cambiada a: ${schoolName}\n\nLos datos se filtrarán automáticamente.`,
            );

            // Recargar página para simular filtrado
            window.location.reload();
        });
    }
</script>

<style>
    select {
        appearance: none;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%236B7280'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: right 0.5rem center;
        background-size: 1.25em 1.25em;
        padding-right: 2.5rem;
    }
</style>
